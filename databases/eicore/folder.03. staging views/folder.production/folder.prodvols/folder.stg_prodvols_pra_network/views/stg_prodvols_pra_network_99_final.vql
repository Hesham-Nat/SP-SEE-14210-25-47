CREATE OR REPLACE VIEW stg_prodvols_pra_network_99_final FOLDER = '/03. staging views/production/prodvols/stg_prodvols_pra_network'
    PRIMARY KEY ( 'dn_number' ) AS SELECT stg_edw_sap_pra_delivery_network.dn_number AS dn_number, stg_prodvols_pra_network_01_variable_data_de.allocated AS allocated, stg_prodvols_pra_network_01_variable_data_de.alloc_method AS allocation_method, stg_edw_sap_pra_delivery_network.allocation_tolerance AS allocation_tolerance, stg_prodvols_pra_network_01_variable_data_de.assume_acr AS assume_acr, stg_prodvols_pra_network_01_variable_data_de.assume_mktgrp AS assume_market_group, stg_edw_sap_pra_delivery_network.company_code AS company_code, stg_edw_sap_pra_delivery_network.country AS country, stg_edw_sap_pra_delivery_network.county_code AS county_code, stg_edw_sap_pra_counties_per_state.geographic_description AS county_name, stg_edw_sap_pra_delivery_network.created_by AS created_by, stg_edw_sap_pra_delivery_network.dn_hierarchy_group AS dn_hierarchy_group, stg_edw_sap_pra_delivery_network.dn_name AS dn_name, stg_edw_sap_pra_delivery_network.dn_number_group AS dn_number_group, stg_edw_sap_pra_delivery_network.dn_type AS dn_type, stg_edw_sap_pra_delivery_network.edw_create_date AS edw_create_date, stg_edw_sap_pra_delivery_network.edw_update_date AS edw_update_date, stg_prodvols_pra_network_01_variable_data_de.entitlement_on_sales AS entitlement_on_sales, stg_prodvols_pra_network_01_variable_data_de.gas_alloc_basis AS gas_alloc_basis, stg_prodvols_pra_network_01_variable_data_de.inactive AS inactive, stg_prodvols_delivery_network_01_major_product_code.major_product_code AS major_product_code, stg_prodvols_delivery_network_01_major_product_gas.major_product_gas AS major_product_gas, stg_prodvols_delivery_network_01_major_product_oil.major_product_oil AS major_product_oil, stg_prodvols_delivery_network_01_major_product_water.major_product_water AS major_product_water, stg_prodvols_pra_network_01_variable_data_de.measurement_group AS measurement_group, stg_prodvols_pra_network_01_variable_data_de.process_freq AS process_freq, stg_prodvols_pra_network_01_variable_data_de.prod_allocation_basis AS prod_allocation_basis, stg_prodvols_pra_network_01_variable_data_de.run_valuation AS run_valuation, stg_edw_sap_pra_delivery_network.state_code AS state_code, stg_edw_sap_pra_state_codes.state_name AS state_name, stg_edw_sap_pra_state_codes.postal_code AS state_postal_id, stg_edw_sap_pra_delivery_network.timestamp AS timestamp, stg_prodvols_pra_network_01_variable_data_de.tolerance_percentage AS tolerance_percentage FROM ((((((stg_sap_pra_delivery_network AS stg_edw_sap_pra_delivery_network LEFT OUTER JOIN stg_prodvols_pra_network_01_major_product_code AS stg_prodvols_delivery_network_01_major_product_code ON stg_edw_sap_pra_delivery_network.dn_number = stg_prodvols_delivery_network_01_major_product_code.dn_number ) LEFT OUTER JOIN stg_prodvols_pra_network_01_major_product_gas AS stg_prodvols_delivery_network_01_major_product_gas ON stg_edw_sap_pra_delivery_network.dn_number = stg_prodvols_delivery_network_01_major_product_gas.dn_number ) LEFT OUTER JOIN stg_prodvols_pra_network_01_major_product_oil AS stg_prodvols_delivery_network_01_major_product_oil ON stg_edw_sap_pra_delivery_network.dn_number = stg_prodvols_delivery_network_01_major_product_oil.dn_number ) LEFT OUTER JOIN stg_prodvols_pra_network_01_major_product_water AS stg_prodvols_delivery_network_01_major_product_water ON stg_edw_sap_pra_delivery_network.dn_number = stg_prodvols_delivery_network_01_major_product_water.dn_number ) LEFT OUTER JOIN stg_sap_pra_state_codes AS stg_edw_sap_pra_state_codes ON (stg_edw_sap_pra_delivery_network.state_code = stg_edw_sap_pra_state_codes.state_code AND stg_edw_sap_pra_delivery_network.country = stg_edw_sap_pra_state_codes.country_code) ) LEFT OUTER JOIN stg_sap_pra_counties_per_state AS stg_edw_sap_pra_counties_per_state ON (stg_edw_sap_pra_delivery_network.state_code = stg_edw_sap_pra_counties_per_state.geographic_location_primary AND stg_edw_sap_pra_delivery_network.county_code = stg_edw_sap_pra_counties_per_state.geographic_location_secondary) ) INNER JOIN stg_prodvols_pra_network_01_variable_data_de AS stg_prodvols_pra_network_01_variable_data_de ON stg_edw_sap_pra_delivery_network.dn_number = stg_prodvols_pra_network_01_variable_data_de.dn_number ;

ALTER VIEW stg_prodvols_pra_network_99_final
 LAYOUT (stg_sap_pra_delivery_network = [0, 208, 200, 225], stg_prodvols_pra_network_01_major_product_code = [250, 0, 200, 66], stg_prodvols_pra_network_01_major_product_gas = [250, 96, 200, 66], stg_prodvols_pra_network_01_major_product_oil = [250, 192, 200, 66], stg_prodvols_pra_network_01_major_product_water = [250, 288, 200, 66], stg_sap_pra_state_codes = [250, 384, 200, 186], stg_sap_pra_counties_per_state = [250, 600, 200, 126], stg_prodvols_pra_network_01_variable_data_de = [250, 755, 200, 225]);

