CREATE OR REPLACE VIEW stg_prodvols_well_daily_volumes_99_final FOLDER = '/03. staging views/production/prodvols/stg_prodvols_well_daily_volumes'
    PRIMARY KEY ( 'item_id' , 'prod_dt' ) AS
    SELECT stg_prodvols_well_daily_volumes_01_base.item_id AS item_id,
           stg_prodvols_well_daily_volumes_01_base.prod_dt AS prod_dt,
           stg_prodvols_well_completion_header_99_final.api AS api,
           stg_prodvols_well_completion_header_99_final.aries_prop_num AS aries_prop_num,
           stg_prodvols_well_completion_header_99_final.avm_network_name AS avm_network_name,
           stg_prodvols_well_completion_header_99_final.avm_ops_region_name AS avm_ops_region_name,
           stg_prodvols_well_completion_header_99_final.budget_node_cd AS budget_node_cd,
           stg_prodvols_well_completion_header_99_final.budget_node_name AS budget_node_name,
           stg_prodvols_well_daily_volumes_01_base.choke AS choke,
           stg_prodvols_well_daily_volumes_01_base.data_format AS data_format,
           stg_prodvols_well_daily_volumes_01_base.data_source AS data_source,
           stg_prodvols_well_daily_volumes_01_base.downtime_cd_1 AS downtime_cd_1,
           stg_prodvols_well_daily_volumes_01_base.downtime_cd_2 AS downtime_cd_2,
           stg_prodvols_well_daily_volumes_01_base.downtime_cd_3 AS downtime_cd_3,
           stg_prodvols_well_daily_volumes_01_base.downtime_comments AS downtime_comments,
           stg_prodvols_well_daily_volumes_01_base.downtime_down_hrs AS downtime_down_hrs,
           stg_prodvols_well_daily_volumes_01_base.downtime_up_hrs AS downtime_up_hrs,
           stg_prodvols_well_completion_header_99_final.facility_name AS facility_name,
           stg_prodvols_well_completion_header_99_final.fdc_id AS fdc_id,
           stg_prodvols_well_daily_volumes_01_base.fdc_id_completion AS fdc_id_completion,
           stg_prodvols_well_daily_volumes_01_base.fdc_id_meter_gas AS fdc_id_meter_gas,
           stg_prodvols_well_daily_volumes_01_base.fdc_id_meter_oil AS fdc_id_meter_oil,
           stg_prodvols_well_daily_volumes_01_base.fdc_id_meter_wtr AS fdc_id_meter_wtr,
           stg_prodvols_well_daily_volumes_01_base.fluid_level_ft AS fluid_level_ft,
           stg_prodvols_well_completion_header_99_final.foreman_name AS foreman_name,
           stg_prodvols_well_daily_volumes_01_base.inv_oil_close_bbl AS inv_oil_close_bbl,
           stg_prodvols_well_daily_volumes_01_base.inv_oil_open_bbl AS inv_oil_open_bbl,
           stg_prodvols_well_daily_volumes_01_base.inv_wtr_close_bbl AS inv_wtr_close_bbl,
           stg_prodvols_well_daily_volumes_01_base.inv_wtr_open_bbl AS inv_wtr_open_bbl,
           stg_prodvols_well_completion_header_99_final.lease_operator_name AS lease_operator_name,
           stg_prodvols_well_daily_volumes_01_base.lift_type AS lift_type,
           stg_prodvols_well_daily_volumes_01_base.operated_flag AS operated_flag,
           stg_prodvols_well_completion_header_99_final.own_nri_gas AS own_nri_gas,
           stg_prodvols_well_completion_header_99_final.own_nri_ngl AS own_nri_ngl,
           stg_prodvols_well_completion_header_99_final.own_nri_oil AS own_nri_oil,
           stg_prodvols_well_daily_volumes_01_base.plunger_arrivals AS plunger_arrivals,
           stg_prodvols_well_daily_volumes_01_base.plunger_open_time AS plunger_open_time,
           stg_prodvols_well_completion_header_99_final.pra_network_name_gas AS pra_network_name_gas,
           stg_prodvols_well_completion_header_99_final.pra_network_name_oil AS pra_network_name_oil,
           stg_prodvols_well_daily_volumes_01_base.pressure_base AS pressure_base,
           stg_prodvols_well_daily_volumes_01_base.pressure_base_factor AS pressure_base_factor,
           stg_prodvols_well_daily_volumes_01_base.pressure_casing_internal_psia AS pressure_casing_internal_psia,
           stg_prodvols_well_daily_volumes_01_base.pressure_casing_internal_psig AS pressure_casing_internal_psig,
           stg_prodvols_well_daily_volumes_01_base.pressure_casing_psia AS pressure_casing_psia,
           stg_prodvols_well_daily_volumes_01_base.pressure_casing_psig AS pressure_casing_psig,
           stg_prodvols_well_daily_volumes_01_base.pressure_casing_surface_psia AS pressure_casing_surface_psia,
           stg_prodvols_well_daily_volumes_01_base.pressure_casing_surface_psig AS pressure_casing_surface_psig,
           stg_prodvols_well_daily_volumes_01_base.pressure_flowing_psia AS pressure_flowing_psia,
           stg_prodvols_well_daily_volumes_01_base.pressure_flowing_psig AS pressure_flowing_psig,
           stg_prodvols_well_daily_volumes_01_base.pressure_pump_intake_psia AS pressure_pump_intake_psia,
           stg_prodvols_well_daily_volumes_01_base.pressure_pump_intake_psig AS pressure_pump_intake_psig,
           stg_prodvols_well_daily_volumes_01_base.pressure_separator_psia AS pressure_separator_psia,
           stg_prodvols_well_daily_volumes_01_base.pressure_separator_psig AS pressure_separator_psig,
           stg_prodvols_well_daily_volumes_01_base.pressure_treater_psia AS pressure_treater_psia,
           stg_prodvols_well_daily_volumes_01_base.pressure_treater_psig AS pressure_treater_psig,
           stg_prodvols_well_daily_volumes_01_base.pressure_tubing_psia AS pressure_tubing_psia,
           stg_prodvols_well_daily_volumes_01_base.pressure_tubing_psig AS pressure_tubing_psig,
           stg_prodvols_well_completion_header_99_final.prod_manager_name AS prod_manager_name,
           stg_prodvols_well_daily_volumes_01_base.prod_month_end_dt AS prod_month_end_dt,
           stg_prodvols_well_daily_volumes_01_base.prod_month_start_dt AS prod_month_start_dt,
           stg_prodvols_well_daily_volumes_01_base.production_days AS production_days,
           stg_prodvols_well_daily_volumes_01_base.pump_depth_ft AS pump_depth_ft,
           stg_prodvols_well_daily_volumes_01_base.pump_frequency_hz AS pump_frequency_hz,
           stg_prodvols_well_daily_volumes_01_base.record_create_date AS record_create_date,
           stg_prodvols_well_completion_header_99_final.region_name AS region_name,
           stg_prodvols_well_completion_header_99_final.route_name AS route_name,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_any_prod AS stat_days_of_any_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_any_prod_reverse AS stat_days_of_any_prod_reverse,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_gas_or_oil_prod AS stat_days_of_gas_or_oil_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_gas_or_oil_prod_reverse AS stat_days_of_gas_or_oil_prod_reverse,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_gas_prod AS stat_days_of_gas_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_gas_prod_reverse AS stat_days_of_gas_prod_reverse,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_liq_prod AS stat_days_of_liq_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_liq_prod_reverse AS stat_days_of_liq_prod_reverse,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_oil_prod AS stat_days_of_oil_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_oil_prod_reverse AS stat_days_of_oil_prod_reverse,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_wtr_prod AS stat_days_of_wtr_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_days_of_wtr_prod_reverse AS stat_days_of_wtr_prod_reverse,
           stg_prodvols_well_daily_volumes_01_base.stat_days_since_last_test AS stat_days_since_last_test,
           stg_prodvols_well_daily_volumes_01_base.stat_has_24hr_downtime_when_producing AS stat_has_24hr_downtime_when_producing,
           stg_prodvols_well_daily_volumes_01_base.stat_has_vol_any_prod AS stat_has_vol_any_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_has_vol_gas_or_oil_prod AS stat_has_vol_gas_or_oil_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_has_vol_gas_prod AS stat_has_vol_gas_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_has_vol_liq_prod AS stat_has_vol_liq_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_has_vol_oil_prod AS stat_has_vol_oil_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_has_vol_wtr_prod AS stat_has_vol_wtr_prod,
           stg_prodvols_well_daily_volumes_01_base.stat_need_24hr_downtime AS stat_need_24hr_downtime,
           stg_prodvols_well_daily_volumes_01_base.stat_ratio_gas_oil AS stat_ratio_gas_oil,
           stg_prodvols_well_daily_volumes_01_base.stat_ratio_wtr_oil AS stat_ratio_wtr_oil,
           stg_prodvols_well_completion_header_99_final.state_name AS state_name,
           stg_prodvols_well_completion_header_99_final.superintendent_name AS superintendent_name,
           stg_prodvols_well_daily_volumes_01_base.system_update_date_meter_daily_volumes AS system_update_date_meter_daily_volumes,
           stg_prodvols_well_daily_volumes_01_base.system_update_date_well_completion_header_dt_eff AS system_update_date_well_completion_header_dt_eff,
           stg_prodvols_well_daily_volumes_01_base.system_update_date_well_daily_downtime AS system_update_date_well_daily_downtime,
           stg_prodvols_well_daily_volumes_01_base.system_update_date_well_daily_reads AS system_update_date_well_daily_reads,
           stg_prodvols_well_daily_volumes_01_base.system_update_date_well_daily_totals AS system_update_date_well_daily_totals,
           stg_prodvols_well_daily_volumes_01_base.system_update_date_well_tests_dt_eff AS system_update_date_well_tests_dt_eff,
           stg_prodvols_well_daily_volumes_01_base.temperature_separator_f AS temperature_separator_f,
           stg_prodvols_well_daily_volumes_01_base.temperature_treater_f AS temperature_treater_f,
           stg_prodvols_well_daily_volumes_01_base.theor_method_gas AS theor_method_gas,
           stg_prodvols_well_daily_volumes_01_base.theor_method_oil AS theor_method_oil,
           stg_prodvols_well_daily_volumes_01_base.theor_method_wtr AS theor_method_wtr,
           stg_prodvols_well_completion_header_99_final.trajectory_type AS trajectory_type,
           stg_prodvols_well_completion_header_99_final.type_curve_region AS type_curve_region,
           stg_prodvols_well_completion_header_99_final.type_curve_subregion AS type_curve_subregion,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_prod_boe AS vol_equiv_prod_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_prod_mcfe AS vol_equiv_prod_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_prod_mmcfe AS vol_equiv_prod_mmcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_sales_boe AS vol_equiv_sales_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_sales_mcfe AS vol_equiv_sales_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_sales_mmcfe AS vol_equiv_sales_mmcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_theor_boe AS vol_equiv_theor_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_theor_mcfe AS vol_equiv_theor_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_theor_mmcfe AS vol_equiv_theor_mmcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_wh_boe AS vol_equiv_wh_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_wh_mcfe AS vol_equiv_wh_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_wh_meter_boe AS vol_equiv_wh_meter_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_wh_meter_mcfe AS vol_equiv_wh_meter_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_wh_meter_mmcfe AS vol_equiv_wh_meter_mmcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_equiv_wh_mmcfe AS vol_equiv_wh_mmcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_flare_mcf AS vol_gas_flare_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_flash_mcf AS vol_gas_flash_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_fuel_mcf AS vol_gas_fuel_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_inj_mcf AS vol_gas_inj_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_prod_boe AS vol_gas_prod_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_prod_mcf AS vol_gas_prod_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_sales_boe AS vol_gas_sales_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_sales_mcf AS vol_gas_sales_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_test_rate_boe AS vol_gas_test_rate_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_test_rate_mcf AS vol_gas_test_rate_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_theor_boe AS vol_gas_theor_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_theor_mcf AS vol_gas_theor_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_total_usage_mcf AS vol_gas_total_usage_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_vent_mcf AS vol_gas_vent_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_wh_boe AS vol_gas_wh_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_wh_mcf AS vol_gas_wh_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_wh_meter_boe AS vol_gas_wh_meter_boe,
           stg_prodvols_well_daily_volumes_01_base.vol_gas_wh_meter_mcf AS vol_gas_wh_meter_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_liq_prod_bbl AS vol_liq_prod_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_prod_bbl AS vol_oil_prod_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_prod_mcfe AS vol_oil_prod_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_sales_bbl AS vol_oil_sales_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_sales_mcfe AS vol_oil_sales_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_skim_bbl AS vol_oil_skim_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_test_rate_bbl AS vol_oil_test_rate_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_test_rate_mcfe AS vol_oil_test_rate_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_theor_bbl AS vol_oil_theor_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_theor_mcfe AS vol_oil_theor_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_wh_bbl AS vol_oil_wh_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_wh_mcfe AS vol_oil_wh_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_wh_meter_bbl AS vol_oil_wh_meter_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_oil_wh_meter_mcfe AS vol_oil_wh_meter_mcfe,
           stg_prodvols_well_daily_volumes_01_base.vol_var_gas_prod_vs_theor_mcf AS vol_var_gas_prod_vs_theor_mcf,
           stg_prodvols_well_daily_volumes_01_base.vol_var_oil_prod_vs_theor_bbl AS vol_var_oil_prod_vs_theor_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_var_wtr_prod_vs_theor_bbl AS vol_var_wtr_prod_vs_theor_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_wtr_inj_bbl AS vol_wtr_inj_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_wtr_prod_bbl AS vol_wtr_prod_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_wtr_test_rate_bbl AS vol_wtr_test_rate_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_wtr_theor_bbl AS vol_wtr_theor_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_wtr_wh_bbl AS vol_wtr_wh_bbl,
           stg_prodvols_well_daily_volumes_01_base.vol_wtr_wh_meter_bbl AS vol_wtr_wh_meter_bbl,
           stg_prodvols_well_daily_volumes_01_base.well_completion_ekey AS well_completion_ekey,
           stg_prodvols_well_completion_header_99_final.well_completion_name AS well_completion_name,
           stg_prodvols_well_daily_volumes_01_base.well_completion_status AS well_completion_status,
           stg_prodvols_well_daily_volumes_01_base.well_read_comments AS well_read_comments
    FROM (
             stg_prodvols_well_daily_volumes_01_base AS stg_prodvols_well_daily_volumes_01_base
             INNER JOIN stg_prodvols_well_completion_header_99_final AS stg_prodvols_well_completion_header_99_final
                 ON stg_prodvols_well_daily_volumes_01_base.item_id = stg_prodvols_well_completion_header_99_final.item_id
         )
         
    CONTEXT (DATAMOVEMENTPLAN = stg_prodvols_well_completion_header_99_final : JDBC ds_avm, 'formatted' = 'yes');

ALTER VIEW stg_prodvols_well_daily_volumes_99_final
 LAYOUT (stg_prodvols_well_daily_volumes_01_base = [20, 20, 440, 360], stg_prodvols_well_completion_header_99_final = [700, 30, 350, 230], "_b7499ada-6f5c-447e-95b6-9531c99edea2" = [710, 490, 410, 145]);

