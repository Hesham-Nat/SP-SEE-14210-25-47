CREATE OR REPLACE VIEW stg_prodvols_well_completion_header_99_final FOLDER = '/03. staging views/production/prodvols/stg_prodvols_well_completion_header' DESCRIPTION = 'The list of Wells for which Daily & Monthly Vols maybe recorded in AVM and PRA.
This view is a representation of the SM Canonical Well Completion header view.

Source:  
The attributes depicted within this view are primarily sourced from WellMaster.
Extraneous attributes may be sourced from ancillary systems (e.g. Aries, AVM, PRA, etc.)' 
    PRIMARY KEY ( 'item_id' ) (
    item_id (description = 'the item_id is a unique identifier within AVM for each Well Completion'),
    wm_field_name (description = 'The geologic field within which the well lies.
    Source:  SM Well Master'),
    own_nri_gas (description = 'SM''s Net Revenue Interest for Gas Products'),
    own_nri_ngl (description = 'SM''s Net Revenue Interest for Liquid Products'),
    own_nri_oil (description = 'SM''s Net Revenue Interest for Oil Products')
 )
 AS SELECT stg_sm_well_completion_header_99_final.avm_item_id AS item_id, stg_sm_well_completion_header_99_final.api AS api, stg_sm_well_completion_header_99_final.aries_prop_num AS aries_prop_num, stg_sm_well_completion_header_99_final.avm_network_name AS avm_network_name, stg_sm_well_completion_header_99_final.avm_ops_region_name AS avm_ops_region_name, stg_sm_well_completion_header_99_final.budget_node_cd AS budget_node_cd, stg_sm_well_completion_header_99_final.budget_node_name AS budget_node_name, stg_sm_well_completion_header_99_final.first_sale_date AS first_sale_date, stg_sm_well_completion_header_99_final.facility_name AS facility_name, stg_sm_well_completion_header_99_final.fdc_id AS fdc_id, stg_sm_well_completion_header_99_final.resp_foreman_name AS foreman_name, stg_sm_well_completion_header_99_final.resp_lease_operator_name AS lease_operator_name, stg_sm_well_completion_header_99_final.onstream_dt AS onstream_dt, (coalesce(stg_sm_well_completion_header_99_final.own_nri_gas, own_nri)/100) AS own_nri_gas, (coalesce(stg_sm_well_completion_header_99_final.own_nri_ngl, own_nri)/100) AS own_nri_ngl, (coalesce(stg_sm_well_completion_header_99_final.own_nri_oil, own_nri)/100) AS own_nri_oil, stg_prodvols_well_completion_header_01_network.pra_network_name_gas, stg_prodvols_well_completion_header_01_network.pra_network_name_oil, stg_sm_well_completion_header_99_final.resp_pmgr_name AS prod_manager_name, stg_sm_well_completion_header_99_final.region_name AS region_name, stg_sm_well_completion_header_99_final.route_name AS route_name, stg_sm_well_completion_header_99_final.sap_well_completion_num, stg_sm_well_completion_header_99_final.sap_well_num, stg_sm_well_completion_header_99_final.state_name AS state_name, stg_sm_well_completion_header_99_final.resp_supt_name AS superintendent_name, stg_sm_well_completion_header_99_final.trajectory_type AS trajectory_type, stg_sm_well_completion_header_99_final.type_curve_region AS type_curve_region, stg_sm_well_completion_header_99_final.type_curve_subregion AS type_curve_subregion, stg_sm_well_completion_header_99_final.wedge AS wedge, stg_sm_well_completion_header_99_final.well_completion_ekey AS well_completion_ekey, stg_sm_well_completion_header_99_final.well_completion_name AS well_completion_name, stg_sm_well_completion_header_99_final.wm_field_name AS wm_field_name FROM stg_sm_well_completion_header_99_final AS stg_sm_well_completion_header_99_final LEFT OUTER JOIN stg_prodvols_well_completion_header_01_network AS stg_prodvols_well_completion_header_01_network ON (stg_prodvols_well_completion_header_01_network.well_id = stg_sm_well_completion_header_99_final.sap_well_num AND stg_prodvols_well_completion_header_01_network.well_completion = stg_sm_well_completion_header_99_final.sap_well_completion_num) ;

ALTER VIEW stg_prodvols_well_completion_header_99_final
 LAYOUT (stg_sm_well_completion_header_99_final = [250, 0, 200, 225], stg_prodvols_well_completion_header_01_network = [0, 59, 200, 106]);

