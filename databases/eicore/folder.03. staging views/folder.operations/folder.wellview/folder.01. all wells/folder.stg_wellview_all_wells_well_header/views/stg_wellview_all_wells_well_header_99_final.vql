CREATE OR REPLACE VIEW stg_wellview_all_wells_well_header_99_final FOLDER = '/03. staging views/operations/wellview/01. all wells/stg_wellview_all_wells_well_header'
    PRIMARY KEY ( 'wellidb' ) AS SELECT idwell AS idwell, agent AS agent, area AS area, basin AS basin, basincode AS basincode, com AS com, country AS country, county AS county, currentwellstatus1 AS currentwellstatus1, currentwellstatus2 AS currentwellstatus2, directionstowell AS directionstowell, district AS district, division AS division, dttmabandon AS dttmabandon, dttmfirstprod AS dttmfirstprod, dttmrr AS dttmrr, dttmspud AS dttmspud, dttmwellclass AS dttmwellclass, dttmwelllic AS dttmwelllic, elvcasflange AS elvcasflange, elvground AS elvground, elvmudline AS elvmudline, elvorigkb AS elvorigkb, elvtubhead AS elvtubhead, environmentsensitive AS environmentsensitive, ewdist AS ewdist, ewflag AS ewflag, fieldcode AS fieldcode, fieldname AS fieldname, fieldoffice AS fieldoffice, govauthority AS govauthority, hih2s AS hih2s, hisitp AS hisitp, idrecelvhistory AS idrecelvhistory, idrecelvhistorytk AS idrecelvhistorytk, idrecproblem AS idrecproblem, idrecproblemtk AS idrecproblemtk, idrecsite AS idrecsite, idrecsitetk AS idrecsitetk, latitude AS latitude, latlongdatum AS latlongdatum, latlongsource AS latlongsource, lease AS lease, leasecode AS leasecode, legalsurveyloc AS legalsurveyloc, legalsurveysubtyp AS legalsurveysubtyp, legalsurveytyp AS legalsurveytyp, locationnote AS locationnote, locationref AS locationref, locationsensitive AS locationsensitive, locationtyp AS locationtyp, longitude AS longitude, nsdist AS nsdist, nsflag AS nsflag, operated AS operated, operator AS operator, operatorcode AS operatorcode, platform AS platform, problemflag AS problemflag, riskclass AS riskclass, slot AS slot, stateprov AS stateprov, surfacerights AS surfacerights, towndist AS towndist, townflag AS townflag, townname AS townname, townstateprov AS townstateprov, userboolean1 AS userboolean1, userboolean2 AS userboolean2, userboolean3 AS userboolean3, userboolean4 AS userboolean4, userboolean5 AS userboolean5, userdttm1 AS userdttm1, userdttm2 AS userdttm2, userdttm3 AS userdttm3, userdttm4 AS userdttm4, userdttm5 AS userdttm5, usernum1 AS usernum1, usernum2 AS usernum2, usernum3 AS usernum3, usernum4 AS usernum4, usernum5 AS usernum5, usertxt1 AS usertxt1, usertxt10 AS usertxt10, usertxt2 AS usertxt2, usertxt3 AS usertxt3, usertxt4 AS usertxt4, usertxt5 AS usertxt5, usertxt6 AS usertxt6, usertxt7 AS usertxt7, usertxt8 AS usertxt8, usertxt9 AS usertxt9, utmgridzone AS utmgridzone, utmsource AS utmsource, utmx AS utmx, utmy AS utmy, waterdepth AS waterdepth, wellclass AS wellclass, wellconfig AS wellconfig, wellida AS wellida, wellidb AS wellidb, wellidc AS wellidc, wellidd AS wellidd, wellide AS wellide, welllicensee AS welllicensee, welllicenseno AS welllicenseno, wellname AS wellname, welltyp1 AS welltyp1, welltyp2 AS welltyp2, workingint AS workingint, syslockmeui AS syslockmeui, syslockchildrenui AS syslockchildrenui, syslockme AS syslockme, syslockchildren AS syslockchildren, syslockdate AS syslockdate, sysmoddate AS sysmoddate, sysmoduser AS sysmoduser, syscreatedate AS syscreatedate, syscreateuser AS syscreateuser, systag AS systag, sysmoddatedb AS sysmoddatedb, sysmoduserdb AS sysmoduserdb, syssecuritytyp AS syssecuritytyp, syslockdatemaster AS syslockdatemaster, source_system AS source_system, row_number() OVER ( PARTITION BY wellidb ORDER BY source_system ASC,  sysmoddate DESC ) AS wellidb_duplicate_rank FROM stg_wellview_all_wells_well_header_01_union;

