CREATE OR REPLACE VIEW stg_aries_interface_incoming_ac_daily_99_final FOLDER = '/03. staging views/reserves/incoming interfaces'
    PRIMARY KEY ( 'wellcompid' , 'd_date' ) AS SELECT DISTINCT stg_prodvols_well_daily_volumes_99_final.well_completion_ekey AS wellcompid, stg_prodvols_well_daily_volumes_99_final.prod_dt AS d_date, stg_prodvols_well_daily_volumes_99_final.vol_oil_prod_bbl AS oil, stg_prodvols_well_daily_volumes_99_final.vol_gas_prod_mcf AS gas, case WHEN (stg_prodvols_well_daily_volumes_99_final.avm_ops_region_name = 'Houston') THEN stg_prodvols_well_daily_volumes_99_final.vol_wtr_wh_bbl ELSE stg_prodvols_well_daily_volumes_99_final.vol_wtr_prod_bbl END AS water, case WHEN (stg_prodvols_well_daily_volumes_99_final.avm_ops_region_name = 'Houston') THEN stg_prodvols_well_daily_volumes_99_final.vol_wtr_prod_bbl END AS water_stgc_alloc, stg_prodvols_well_daily_volumes_99_final.vol_wtr_inj_bbl AS water_inj, stg_prodvols_well_daily_volumes_99_final.pressure_casing_psig AS casing_press, stg_prodvols_well_daily_volumes_99_final.pressure_tubing_psig AS tubing_press, stg_prodvols_well_daily_volumes_99_final.pressure_pump_intake_psig AS pump_intk_press, stg_prodvols_well_daily_volumes_99_final.choke AS choke, case WHEN ((stg_prodvols_well_daily_volumes_99_final.operated_flag = 'True' AND stg_prodvols_well_daily_volumes_99_final.avm_ops_region_name = 'Houston')) THEN stg_prodvols_well_daily_volumes_99_final.vol_gas_wh_mcf END AS grs_wh_gas, stg_prodvols_well_daily_volumes_99_final.vol_oil_wh_bbl AS wh_oil, stg_prodvols_well_daily_volumes_99_final.vol_oil_theor_bbl AS theoretical_oil_vol, case WHEN ((stg_prodvols_well_daily_volumes_99_final.system_update_date_meter_daily_volumes >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_reads AND stg_prodvols_well_daily_volumes_99_final.system_update_date_meter_daily_volumes >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_totals AND stg_prodvols_well_daily_volumes_99_final.system_update_date_meter_daily_volumes >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_tests_dt_eff)) THEN stg_prodvols_well_daily_volumes_99_final.system_update_date_meter_daily_volumes WHEN ((stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_reads >= stg_prodvols_well_daily_volumes_99_final.system_update_date_meter_daily_volumes AND stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_reads >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_totals AND stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_reads >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_tests_dt_eff)) THEN stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_reads WHEN ((stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_totals >= stg_prodvols_well_daily_volumes_99_final.system_update_date_meter_daily_volumes AND stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_totals >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_reads AND stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_totals >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_tests_dt_eff)) THEN stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_totals WHEN ((stg_prodvols_well_daily_volumes_99_final.system_update_date_well_tests_dt_eff >= stg_prodvols_well_daily_volumes_99_final.system_update_date_meter_daily_volumes AND stg_prodvols_well_daily_volumes_99_final.system_update_date_well_tests_dt_eff >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_reads AND stg_prodvols_well_daily_volumes_99_final.system_update_date_well_tests_dt_eff >= stg_prodvols_well_daily_volumes_99_final.system_update_date_well_daily_totals)) THEN stg_prodvols_well_daily_volumes_99_final.system_update_date_well_tests_dt_eff ELSE stg_prodvols_well_daily_volumes_99_final.system_update_date_meter_daily_volumes END AS avm_update_date, stg_prodvols_well_daily_volumes_99_final.record_create_date AS prodvols_record_create_date FROM stg_prodvols_well_daily_volumes_99_final AS stg_prodvols_well_daily_volumes_99_final INNER JOIN stg_aries_interface_incoming_effective_start_dates_99_final AS stg_aries_interface_incoming_effective_start_dates ON (stg_prodvols_well_daily_volumes_99_final.avm_ops_region_name = stg_aries_interface_incoming_effective_start_dates.avm_ops_region_name AND stg_prodvols_well_daily_volumes_99_final.operated_flag = stg_aries_interface_incoming_effective_start_dates.operated_flag AND stg_prodvols_well_daily_volumes_99_final.prod_dt >= stg_aries_interface_incoming_effective_start_dates.prod_dt)  CONTEXT (DATAMOVEMENTPLAN = stg_aries_interface_incoming_effective_start_dates_99_final : JDBC ds_avm stg_prodvols_well_completion_header_99_final : JDBC ds_avm);

ALTER VIEW stg_aries_interface_incoming_ac_daily_99_final
 LAYOUT (stg_prodvols_well_daily_volumes_99_final = [0, 0, 240, 460], stg_aries_interface_incoming_effective_start_dates_99_final = [410, 50, 200, 86]);

